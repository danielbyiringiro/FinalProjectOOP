import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;

public class WeatherAPI {

    private static final String API_KEY = "470fb946a8d245caac2200606230804";
    private static final String API_URL = "http://api.weatherapi.com/v1/history.json?key=%s&q=%s&dt=%s";

    /**
     * Returns historical weather data for the specified location and date
     * @param location the location for which to retrieve historical weather data
     * @param date the date for which to retrieve historical weather data
     * @return the JSON response containing the historical weather data
     * @throws IOException if an error occurs while retrieving the data
     */
    public static String getHistoricalWeather(String location, LocalDate date) throws IOException {
        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd");
        String formattedDate = date.format(formatter);

        String apiUrl = String.format(API_URL, API_KEY, location, formattedDate);
        URL url = new URL(apiUrl);

        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setRequestMethod("GET");

        BufferedReader reader = new BufferedReader(new InputStreamReader(connection.getInputStream()));
        String line;
        StringBuilder response = new StringBuilder();

        while ((line = reader.readLine()) != null) {
            response.append(line);
        }

        reader.close();
        connection.disconnect();

        return response.toString();
    }
}
